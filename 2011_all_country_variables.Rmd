---
title: "2011_data_all_variables"
author: "Owen Liu"
date: "August 17, 2016"
output: html_document
---

```{r setup, include=FALSE}
library(plyr)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
lunique <- function(x) length(unique(x))

# Working directory
W_D <- getwd() # Owen's working directory where all the scripts are.  Data files are in this wd/data

# Renato's world trade dataset
trade <- read.csv(file=paste0(W_D,"/data/WORLD_TRADE.csv"))

# Trujillo ecological data
# By country
truj.coun <- read.csv(file=paste0(W_D,"/data/trujillo_countries.csv"))
# Fix the names (for descriptions of variables, see Trujillo 2008 in Alder and Pauly, 2008)
names(truj.coun) <- c("country","native","ex.imp","fishmeal","intensity","nutri","hatchery","antibiotic","habitat","GMO","code","trace","employment","waste")

# By species
truj.spe <- read.csv(file=paste0(W_D,"/data/trujillo_species.csv"))
# Fix the names
names(truj.spe) <- c("country","species","native","fishmeal","intensity","hatchery","habitat","waste","ecol.score","msi")

# Nutritional status and food security by country
foodsecurity <- read.csv(file=paste0(W_D,"/data/FOOD SECURITY and NUTRIENT INTAKES.csv")) %>% select(-X,-X.1)
```


Pull out 2011 data, and join all datasets by country

```{r join data}

# Join nutritional status data to trade and Trujillo country data and remove excess columns
trade <- trade %>% filter(year==2011) # Just year 2011

coun.data <- full_join(trade,foodsecurity,by=c("country","year"))
coun.data <- coun.data[,-1]
coun.data <- full_join(coun.data,truj.coun,by="country")

# Save data
write.csv(coun.data,file=paste0(W_D,"/data/country_data_2011_full.csv"))

```